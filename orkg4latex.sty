%% ----------------------------------------------------------------
%% orkg4latex --- ORKG4LaTeX makes it possible to annotate specific
%% research contributions directly in the LaTeX source code. The 
%% idea of extracting research contributions from scholarly 
%% publications is derived from the Open Research Knowledge Graph 
%% (ORKG).
%% E-mail: christofbless@gmail.com
%% Released under the LaTeX Project Public License v1.3c or later
%% See http://www.latex-project.org/lppl.txt
%% ----------------------------------------------------------------
%% 
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{orkg4latex}[2021/12/21 v1.0]

\def\useignorespacesandallpars#1\ignorespaces\fi{%
#1\fi\ignorespacesandallpars}

\makeatletter
\def\ignorespacesandallpars{%
  \@ifnextchar\par
    {\expandafter\ignorespacesandallpars\@gobble}%
    {}%
}
\makeatother

% used to display the  
\usepackage{verbatim}
\usepackage{suffix}
\usepackage{hyperref}

\errorcontextlines=5

\directlua {
  ORKG = require('orkg4latex')
}

\newcommand{\ORKGaddproperty}[2][]{%
  \directlua{%
    local new_property = "\luaescapestring{\unexpanded{#2}}"%
    local ns = "\luaescapestring{\unexpanded{#1}}"%
    ORKG:make_new_property(new_property, ns)%
  }%
  \ignorespaces
}%

\newcommand{\ORKGrenderxmp}{%
  \newpage
  \verbatiminput{xmp_metadata.xml}
}

\newcommand{\ORKGuri}[2]{%
  \directlua{%
    local label = "\luaescapestring{\unexpanded{#2}}"%
    local uri = "\luaescapestring{\unexpanded{#1}}"%
    ORKG:print_entity(uri, label)%
  }
}

\ORKGaddproperty{ORKGresearchproblem}
\ORKGaddproperty{ORKGresult}
\ORKGaddproperty{ORKGmethod}
\ORKGaddproperty{ORKGbackground}
\ORKGaddproperty{ORKGconclusion}
 
%% Copyright (C) 2021 by You christofbless@gmail.com
%% 
%% This work may be distributed and/or modified under the
%% conditions of the LaTeX Project Public License (LPPL), either
%% version 1.3c of this license or (at your option) any later
%% version.  The latest version of this license is in the file:
%% 
%% http://www.latex-project.org/lppl.txt
%% 
%% This work is "maintained" (as per LPPL maintenance status) by
%% You.
%% 
%% This work consists of the file orkg4latex.sty
%% and the lua file               orkg4latex.lua.
%% 
%%
%% End of file `orkg4latex.sty'.
